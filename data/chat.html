<!DOCTYPE html>
<html>
<head>
    <title>Society Assistant</title>
    <style>
        body {
          margin:0;
          font-family: Arial;
          background:#e5ddd5;
        }

        .chat-container {
          width:400px;
          height:600px;
          margin:30px auto;
          background:white;
          display:flex;
          flex-direction:column;
          border-radius:15px;
          box-shadow:0 4px 15px rgba(0,0,0,0.2);
          overflow:hidden;
        }

        .header {
          background:#075E54;
          color:white;
          padding:15px;
          font-weight:bold;
        }

        .messages {
          flex:1;
          padding:15px;
          overflow-y:auto;
        }

        .message {
          max-width:75%;
          padding:10px 14px;
          border-radius:18px;
          margin-bottom:10px;
          font-size:14px;
        }

        .user {
          background:#dcf8c6;
          align-self:flex-end;
          margin-left:auto;
        }

        .bot {
          background:#f1f0f0;
          align-self:flex-start;
        }

        .input-area {
          display:flex;
          padding:10px;
          border-top:1px solid #ddd;
        }

        .typing span {
          display:inline-block;
          width:6px;
          height:6px;
          margin:0 2px;
          background:#999;
          border-radius:50%;
          animation: blink 1.4s infinite both;
        }

       .typing span:nth-child(2) {
         animation-delay: .2s;
       }
       .typing span:nth-child(3) {
         animation-delay: .4s;
       }

       @keyframes blink {
         0% { opacity:.2; }
         20% { opacity:1; }
         100% { opacity:.2; }
       }

        input {
          flex:1;
          padding:10px;
          border-radius:20px;
          border:1px solid #ccc;
          outline:none;
        }

        button {
          margin-left:8px;
          padding:10px 15px;
          border:none;
          border-radius:20px;
          background:#075E54;
          color:white;
          cursor:pointer;
        }
    </style>
</head>
<body>

<div class="chat-container">
    <div class="header">Society Assistant ðŸ¤–</div>
    <div id="messages" class="messages"></div>
    <div class="input-area">
        <input type="text" id="message" placeholder="Type a message...">
        <button onclick="sendMessage()">Send</button>
    </div>
</div>

<script>
    async function sendMessage() {
      const input = document.getElementById("message");
      const msg = input.value.trim();
      if (!msg) return;

      const messagesDiv = document.getElementById("messages");

      // Show user message
      messagesDiv.innerHTML += `<div class="message user">${msg}</div>`;
      input.value = "";

      // Show typing indicator
      const typingId = "typing-" + Date.now();
      messagesDiv.innerHTML += `
        <div class="message bot" id="${typingId}">
          <span class="typing">
            <span></span><span></span><span></span>
          </span>
        </div>
      `;

      messagesDiv.scrollTop = messagesDiv.scrollHeight;

      const response = await fetch("http://localhost:5005/webhooks/rest/webhook", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({
          sender: "user1",
          message: msg
        })
      });

      const data = await response.json();

      // Remove typing
      document.getElementById(typingId).remove();

      data.forEach(botMsg => {
        if (botMsg.text) {
         messagesDiv.innerHTML += `
        <div class="message bot">
          ${botMsg.text}
        </div>
        `;
        }
      });

      messagesDiv.scrollTop = messagesDiv.scrollHeight;
    }
</script>
<script>
    document.getElementById("message")
      .addEventListener("keypress", function(event) {
        if (event.key === "Enter") {
          event.preventDefault();
          sendMessage();
        }
    });
</script>
</body>
</html>